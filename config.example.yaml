
# 配置文件示例

# 基本配置
log_dir: "/Users/LG/tutorial/akshare_data/logs"
log_level: "INFO"
task_registry_file: "/Users/LG/tutorial/akshare_data/task_registry.json"

# 数据库配置
database:
  driver: 'mysql+pymysql'
  host: 'localhost'
  port: 3306
  username: 'root'  # 请修改为实际用户名
  password: YOUR_PASSWORD  # or set env MYSQL_PASSWORD# 请修改为实际密码
  database: 'akshare_data'  # 请修改为实际数据库名
  pool_size: 10
  max_overflow: 20
  pool_recycle: 3600


# 数据获取配置
fetcher:
  type: "akshare"
  config: {}

# 数据处理配置
processor:
  # 是否启用数据转换功能
  enable_transformer: true  # 设置为false可禁用数据转换功能
  
  cleaner_type: "standard"
  cleaner_config:
    fill_na: true
    na_values: ["-", "N/A", "n/a", "null", "NULL", "None", ""]
    add_params_as_columns: true
  
  transformer_config:
    add_metadata: true
    batch_size: 1000

# 数据存储配置
storage:
  driver: 'mysql+pymysql'
  host: 'localhost'
  port: 3306
  username: 'root'  # 请修改为实际用户名
  password: YOUR_PASSWORD  # or set env MYSQL_PASSWORD# 请修改为实际密码
  database: 'akshare_data'  # 请修改为实际数据库名
  batch_size: 1000
  retry_count: 3
  # 自动建表功能
  auto_create_table: true  # 设置为true启用自动建表功能，false禁用
  auto_create_table_options:
    add_primary_key: true  # 是否添加自增主键
    add_insert_time: true  # 是否添加插入时间列
    add_update_time: true  # 是否添加更新时间列

# 模式映射配置（示例）
schema_mapping:
  # 股票行情数据
  "stock_zh_a_hist":  # 已更新为新版AkShare接口名称
    table_name: "stock_market_data"
    interface_id: 1
    column_mapping:
      "日期": "trade_datetime"
      "开盘": "open_price"
      "收盘": "close_price"
      "最高": "high_price"
      "最低": "low_price"
      "成交量": "volume"
      "成交额": "amount"
      "振幅": "amplitude"
      "涨跌幅": "change_percent"
      "涨跌额": "change_amount"
      "换手率": "turnover_rate"
      "代码": "param_symbol"
      "名称": "stock_name"
      "param_symbol": "param_symbol"
  
  # 港股分时数据
  "stock_hk_hist_min_em":  # 已更新为新版AkShare接口名称
    table_name: "raw_stock_hk_hist_min_em"
    interface_id: stock_hk_hist_min_em
    column_mapping:
      "时间": "trade_datetime"
      "开盘": "open_price"
      "收盘": "close_price"
      "最高": "high_price"
      "最低": "low_price"
      "成交量": "volume"
      "成交额": "amount"
      "涨跌幅": "price_change_percentage"
      "涨跌额": "price_change_amount"
      "振幅": "price_range_percentage"
      "换手率": "turn_over_rate"
      "param_symbol": "param_symbol"
      "param_period": "param_period"
      "param_adjust": "param_adjust"

  # 美股分时数据
  "stock_us_hist_min_em":  # 已更新为新版AkShare接口名称
    table_name: "raw_stock_us_hist_min_em"
    interface_id: 2
    column_mapping:
      "时间": "trade_datetime"
      "开盘": "open_price"
      "收盘": "close_price"
      "最高": "high_price"
      "最低": "low_price"
      "成交量": "volume"
      "成交额": "amount"
      "最新价": "latest_price"
      "param_symbol": "param_symbol"

  # 国内期货分时数据
  "futures_zh_minute_sina":  # 已更新为新版AkShare接口名称
    table_name: "raw_futures_zh_minute_sina"
    interface_id: futures_zh_minute_sina
    column_mapping:
      "datetime": "trade_datetime"
      "open": "open_price"
      "close": "close_price"
      "high": "high_price"
      "low": "low_price"
      "volume": "volume"
      "hold": "hold"
      "param_symbol": "param_symbol"
      "param_period": "param_period"
      

  # 宏观经济数据
  "macro_china_*":  # 已更新为新版AkShare接口名称
    table_name: "macro_economic_indicators"
    interface_id: 4
    column_mapping:
      "指标名称": "indicator_name"
      "数值": "indicator_value"
      "日期": "data_date"
      "地区": "region"
      "国家": "country"
      "单位": "unit"

  # 外汇汇率数据
  "fx_spot_quote":  # 已更新为新版AkShare接口名称
    table_name: "forex_exchange_rates"
    interface_id: 5
    column_mapping:
      "货币对": "currency_pair"
      "买入价": "bid_rate"
      "卖出价": "ask_rate"
      "中间价": "exchange_rate"
      "时间": "rate_time"
      "日期": "rate_date"

  # 外汇汇率数据
  "fx_spot_quote":  # 已更新为新版AkShare接口名称
    table_name: "forex_exchange_rates"
    interface_id: 6
    column_mapping:
      "货币对": "currency_pair"
      "买入价": "bid_rate"
      "卖出价": "ask_rate"
      "中间价": "exchange_rate"
      "时间": "rate_time"
      "日期": "rate_date"

# 确定是否开启全部列匹配（用于比对和更新）
compare_all_columns: false

# 对比的参数控制：
comparison:
  enable_diff_logging: true  # 是否启用差异记录
  diff_log_table: "data_comparison_diff_log"  # 差异记录表名
  exclude_columns:  # 比对时排除的列
    - "insert_time"
    - "update_time"
    - "created_at"
    - "updated_at"
    - "fetch_time"
  # 可以针对特定表设置排除列
  table_exclude_columns:
    raw_stock_us_daily:
      - "volume"  # 例如排除volume列


# 键列配置（用于比对和更新）
key_columns:
  "stock_market_data": ["trade_datetime", "stock_code"]
  "macro_economic_indicators": ["data_datetime", "indicator_name", "country"]
  "forex_exchange_rates": ["rate_date", "currency_pair"]
  "raw_stock_us_daily": ["trade_datetime", "param_symbol", "param_adjust"]
  #"raw_stock_hk_daily": ["date", "open", "high", "low", "close", "param_symbol", "param_adjust"]
  "raw_futures_zh_minute_sina": ["trade_datetime", "param_symbol", "param_period"]
  "raw_stock_us_hist_min_em": ["trade_datetime", "param_symbol"]
  "raw_stock_hk_hist_min_em": ["trade_datetime", "param_symbol", "param_period"]

# 唯一约束配置（用于防止重复插入）
unique_constraints:
  "stock_market_data": ["trade_datetime", "stock_code"]
  "macro_economic_indicators": ["data_datetime", "indicator_name", "country", "frequency"]
  "forex_exchange_rates": ["rate_date", "rate_time", "currency_pair", "source"]
  "raw_futures_zh_minute_sina": ["trade_datetime", "param_symbol", "param_period"]
  "raw_stock_us_hist_min_em": ["trade_datetime", "param_symbol"]
  "raw_stock_hk_hist_min_em": ["trade_datetime", "param_symbol", "param_period"]